<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulačka promile</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #1a1a1a;
            color: #e0e0e0;
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            text-align: center;
            padding: 40px 0;
        }
        header h1 {
            font-size: 2.5em;
            color: #3b82f6;
        }
        header p {
            font-size: 1.2em;
            color: #a0a0a0;
        }
        .section {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        .section h2 {
            color: #3b82f6;
            margin-top: 0;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #3b82f6;
            border-radius: 4px;
            background-color: #333;
            color: #e0e0e0;
        }
        .form-group select option {
            background-color: #333;
            color: #e0e0e0;
        }
        .drink-container {
            margin-bottom: 15px;
        }
        .drink-container button {
            background-color: #3b82f6;
            border: none;
            padding: 10px;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            margin-top: 10px;
        }
        .drink-container button:hover {
            background-color: #2563eb;
        }
        #result {
            display: none;
        }
        #result h3 {
            color: #3b82f6;
        }
        .warning {
            color: #f87171;
            font-size: 0.9em;
            margin-top: 10px;
        }
        footer {
            text-align: center;
            padding: 20px 0;
            color: #a0a0a0;
            font-size: 0.9em;
        }
        button#calculate {
            background-color: #3b82f6;
            border: none;
            padding: 15px 30px;
            border-radius: 4px;
            color: white;
            font-size: 1.1em;
            cursor: pointer;
            display: block;
            margin: 20px auto;
        }
        button#calculate:hover {
            background-color: #2563eb;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Kalkulačka promile</h1>
            <p>Zodpovědně odhadněte svou hladinu alkoholu v krvi</p>
        </header>

        <div class="section">
            <h2>Jak to funguje</h2>
            <p>Naše kalkulačka využívá Widmarkovu formuli pro přesný odhad hladiny alkoholu v krvi (BAC) na základě vědecky ověřených údajů. Zohledňuje pohlaví, věk, hmotnost, výšku a čas od začátku pití. Výsledek je pouze orientační a neměl by být považován za náhradu profesionálního měření.</p>
            <p class="warning">Varování: Alkohol ovlivňuje každého jinak. Nepoužívejte tyto údaje k rozhodování o řízení vozidla nebo jiných činnostech vyžadujících plnou střízlivost.</p>
        </div>

        <div class="section">
            <h2>Kalkulačka</h2>
            <div class="form-group">
                <label for="gender">Pohlaví</label>
                <select id="gender" required>
                    <option value="">Vyberte pohlaví</option>
                    <option value="male">Muž</option>
                    <option value="female">Žena</option>
                </select>
            </div>
            <div class="form-group">
                <label for="weight">Hmotnost (kg)</label>
                <input type="number" id="weight" min="30" max="200" required>
            </div>
            <div class="form-group">
                <label for="height">Výška (cm)</label>
                <input type="number" id="height" min="100" max="250" required>
            </div>
            <div class="form-group">
                <label for="age">Věk</label>
                <input type="number" id="age" min="18" max="100" required>
            </div>
            <div class="form-group">
                <label for="start-time">Čas začátku pití</label>
                <input type="datetime-local" id="start-time" required>
            </div>
            <div id="drinks">
                <h3>Přidat nápoj</h3>
                <div class="drink-container">
                    <div class="form-group">
                        <label for="drink-type">Typ nápoje</label>
                        <select class="drink-type">
                            <option value="">Vyberte nápoj</option>
                            <option value="beer10">Pivo 10° (0,5 l)</option>
                            <option value="beer12">Pivo 12° (0,5 l)</option>
                            <option value="wine">Víno (1 dcl)</option>
                            <option value="spirit">Tvrdý alkohol (0,04 l)</option>
                        </select>
                    </div>
                    <button onclick="addDrink()">Přidat další nápoj</button>
                </div>
            </div>
            <button id="calculate">Vypočítat</button>
        </div>

        <div class="section" id="result">
            <h3>Výsledek</h3>
            <p><strong>Odhadovaná hladina alkoholu (BAC):</strong> <span id="bac"></span> ‰</p>
            <p><strong>Odhadovaný čas do úplného vystřízlivění:</strong> <span id="sober-time"></span></p>
            <p class="warning">Tyto údaje jsou pouze orientační. Nepoužívejte je k rozhodování o řízení vozidla.</p>
        </div>

        <footer>
            <p><strong>Právní upozornění:</strong> Tato kalkulačka poskytuje orientační odhad a není právně závazná. Hladina alkoholu v krvi může být ovlivněna mnoha faktory, které nelze přesně změřit. Za žádných okolností neřiďte vozidlo po požití alkoholu.</p>
        </footer>
    </div>

    <script>
        function addDrink() {
            const drinksContainer = document.getElementById('drinks');
            const newDrink = document.createElement('div');
            newDrink.className = 'drink-container';
            newDrink.innerHTML = `
                <div class="form-group">
                    <label for="drink-type">Typ nápoje</label>
                    <select class="drink-type">
                        <option value="">Vyberte nápoj</option>
                        <option value="beer10">Pivo 10° (0,5 l)</option>
                        <option value="beer12">Pivo 12° (0,5 l)</option>
                        <option value="wine">Víno (1 dcl)</option>
                        <option value="spirit">Tvrdý alkohol (0,04 l)</option>
                    </select>
                </div>
                <button onclick="this.parentElement.remove()">Odebrat</button>
            `;
            drinksContainer.appendChild(newDrink);
        }

        document.getElementById('calculate').addEventListener('click', () => {
            const gender = document.getElementById('gender').value;
            const weight = parseFloat(document.getElementById('weight').value);
            const height = parseFloat(document.getElementById('height').value);
            const age = parseFloat(document.getElementById('age').value);
            const startTime = new Date(document.getElementById('start-time').value);
            const drinks = document.querySelectorAll('.drink-type');

            if (!gender || !weight || !height || !age || !startTime || drinks.length === 0) {
                alert('Vyplňte všechny údaje a přidejte alespoň jeden nápoj.');
                return;
            }

            // Widmark formula constants
            const r = gender === 'male' ? 0.68 : 0.55;
            const beta = 0.15; // g/L/h
            const currentTime = new Date();
            const timeDiff = (currentTime - startTime) / (1000 * 60 * 60); // hours

            // Calculate total alcohol in grams
            let totalAlcohol = 0;
            drinks.forEach(drink => {
                const type = drink.value;
                if (type === 'beer10') totalAlcohol += 20;
                else if (type === 'beer12') totalAlcohol += 25;
                else if (type === 'wine') totalAlcohol += 10;
                else if (type === 'spirit') totalAlcohol += 12.6;
            });

            // Widmark formula: BAC = (A * 0.789) / (r * m) - β * t
            const bac = Math.max(0, ((totalAlcohol * 0.789) / (r * weight)) - (beta * timeDiff));
            const soberHours = bac / beta;
            const soberTime = new Date(currentTime.getTime() + soberHours * 60 * 60 * 1000);

            // Display results
            document.getElementById('bac').textContent = bac.toFixed(2);
            document.getElementById('sober-time').textContent = soberTime.toLocaleString('cs-CZ');
            document.getElementById('result').style.display = 'block';
        });
    </script>
</body>
</html>
